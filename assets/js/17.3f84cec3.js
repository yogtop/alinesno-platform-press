(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{235:function(t,_,v){"use strict";v.r(_);var e=v(0),i=Object(e.a)({},(function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),v("p",[t._v("数据仓库分层，纵向层级的划分相对来说更为成熟与统一。尽管不同的公司和业务线的\n纵向层级有的是四层，有的是五层，但究其本质都是三层结构，即原始层、中间层和应用层")]),t._v(" "),v("p",[t._v("通过对数仓在纵向进行分层，具有以下好处：")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),v("p",[t._v("数据分层按通用的数据分层结构，整体如下：")]),t._v(" "),t._m(4),t._v(" "),v("img",{attrs:{src:t.$withBase("/data/data-layer-03.png")}}),t._v(" "),v("p",[t._v("说明：")]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),v("img",{attrs:{src:t.$withBase("/data/data-layer.png")}}),t._v(" "),v("p",[t._v("说明：")]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),v("p",[t._v("数据处理大致可以分成两大类:联机事务处理 OLTP(on -line- transaction processing)、\n联机分析处理 AP(On-ine Analytical Processing)OLTP 是传统的关系型\n数据库的主要应用,主要是基本的、日常的事务处理,例如银行交易。OLAP 是数据仓库系\n统的主要应用,支持复杂的分析操作,侧重决策支持,并且提供直观易懂的查询结果。二者\n的主要区别对比如下表所示。")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),v("p",[t._v("主要存放公共的信息数据,比如国家代码和国家名，地理位置等信息就存在 DIM 层表中，\n对外开放,用于 DWD，DWS 和 APP 层的数据维度关联。可以理解为一些字典表、单独存放")]),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),v("p",[t._v("用于源系统数据在数据平台中的永久存储。它用以支撑 DWS 层和 DM 层无法覆盖的需求，\n比如像用户通话详单类业务需求。")]),t._v(" "),v("p",[t._v("该层的数据模型不建议开给不懂技术的业务人员直接使用。\n这一层主要解决一些数据质量问题和数据的完整度问题。")]),t._v(" "),v("p",[t._v("比如商场的会员信息来与不同表，\n某些会员的的和数据可能不完整等等问题,我们可以再这一层做一些屏蔽")]),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),v("p",[t._v("主要包含两类汇总表:一是细粒度宽表，二是粗粒度汇总表。")]),t._v(" "),v("p",[t._v("我们拿商场售卖举例，那么包含基于订单、会员、商品、店铺等实体的细粒度宽表和基于维度组合(会员日进场汇总、\n会员消费汇总、商场销售日汇总、店铺销售日汇总等)的粗粒度汇总表。")]),t._v(" "),v("p",[t._v("这层是对外开放的，\n用以支撑绝大部分的业务需求，汇总层是为了简化源系统复杂的逻辑关系以及质量问题等,\n这层是的业务结构容易理解。")]),t._v(" "),v("p",[t._v("各个层面的工程师容易上手。dws 层的汇总数据目标是能满足 80%的业务计算。")]),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),v("p",[t._v("主要是提供给数据产品和数据分析使用的数据，一般会存放在 ES、PostgreSql、Redis 等系统\n中供线上系统使用，也可能会存在 Hive 或者 Druid 中供数据分析和数据挖掘使用。比如我们\n经常说的报表数据，一般就放在这里。")])])}),[function(){var t=this.$createElement,_=this._self._c||t;return _("h1",{attrs:{id:"数仓分层"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#数仓分层"}},[this._v("#")]),this._v(" 数仓分层")])},function(){var t=this.$createElement,_=this._self._c||t;return _("h2",{attrs:{id:"概述"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[this._v("#")]),this._v(" 概述")])},function(){var t=this.$createElement,_=this._self._c||t;return _("ul",[_("li",[this._v("复杂问题简单化：每层只负责某个复杂问题的一部分，方便问题的处理，并在出现故障时能够快速定位")]),this._v(" "),_("li",[this._v("减少重复开发：把一些通用性的数据逻辑抽离出来，方便进行复用，避免重复开发")]),this._v(" "),_("li",[this._v("数据解耦：当出现问题时不至于因为某个小问题而影响大片业务")])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h2",{attrs:{id:"分层规划"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#分层规划"}},[this._v("#")]),this._v(" 分层规划")])},function(){var t=this.$createElement,_=this._self._c||t;return _("h3",{attrs:{id:"整体分层结构"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#整体分层结构"}},[this._v("#")]),this._v(" 整体分层结构")])},function(){var t=this.$createElement,_=this._self._c||t;return _("ul",[_("li",[this._v("ODS 层：直接接入的原始日期数据，从业务库直接同步而来的数据")]),this._v(" "),_("li",[this._v("DW 层：包含有数据逻辑处理层，进行数据的清洗，加工，同时对数据进行多维度的提炼")]),this._v(" "),_("li",[this._v("APP 层：用于个性化数据场景处理，使用于特定的业务场景")]),this._v(" "),_("li",[this._v("DIM 层：主要用于数据配置，提供公共参数类型")])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h3",{attrs:{id:"细节分层结构"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#细节分层结构"}},[this._v("#")]),this._v(" 细节分层结构")])},function(){var t=this.$createElement,_=this._self._c||t;return _("blockquote",[_("p",[this._v("整体如下")])])},function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ul",[v("li",[v("p",[t._v("ODS 层：原始数据层,存放原始数据,直接加载原始日志、数据,数据保持原貌不做处理。")])]),t._v(" "),v("li",[v("p",[t._v("DWD 层：对 ODS 层数据进行清洗，主要包括：")]),t._v(" "),v("ul",[v("li",[t._v("去除空值")]),t._v(" "),v("li",[t._v("脏数据")]),t._v(" "),v("li",[t._v("超过极限范围的数据")]),t._v(" "),v("li",[t._v("行式存储改为列存储")]),t._v(" "),v("li",[t._v("改压缩格式")]),t._v(" "),v("li",[t._v("保存明细数据,一行信息代表一次业务行为,例如一次下单.")])])]),t._v(" "),v("li",[v("p",[t._v("DWS 层：以 DWD 为基础,按天进行轻度汇总。一行信息代表一个主题对象一天的汇总行为,例如\n一个用户一天下单次数")])]),t._v(" "),v("li",[v("p",[t._v("DWT 层：以 DWS 为基础,对数据进行累积汇总。一行信息代表一个主题对象的累积行为,例如一个\n用户从注册那天开始至今一共下了多少次单")])]),t._v(" "),v("li",[v("p",[t._v("ADS 层：为各种统计报表提供数据")])])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h2",{attrs:{id:"数仓命名规范"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#数仓命名规范"}},[this._v("#")]),this._v(" 数仓命名规范")])},function(){var t=this.$createElement,_=this._self._c||t;return _("h3",{attrs:{id:"表命名"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#表命名"}},[this._v("#")]),this._v(" 表命名")])},function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ul",[v("li",[t._v("ODS 层命名为"),v("code",[t._v("ods_")]),t._v("表名")]),t._v(" "),v("li",[t._v("DWD 层命名为"),v("code",[t._v("dwd_dim/fact_")]),t._v("表名")]),t._v(" "),v("li",[t._v("DWS 层命名为"),v("code",[t._v("dws_")]),t._v("表名")]),t._v(" "),v("li",[t._v("DWT 层命名为"),v("code",[t._v("dwt_")]),t._v("表名")]),t._v(" "),v("li",[t._v("ADS 层命名为"),v("code",[t._v("ads_")]),t._v("表名")]),t._v(" "),v("li",[t._v("临时表命名为"),v("code",[t._v("xxx_tmp")])]),t._v(" "),v("li",[t._v("用户行为表,以"),v("code",[t._v("log")]),t._v("为后缀。")])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h3",{attrs:{id:"脚本命名"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#脚本命名"}},[this._v("#")]),this._v(" 脚本命名")])},function(){var t=this.$createElement,_=this._self._c||t;return _("ul",[_("li",[this._v("数据源 to 目标 db/logsh")]),this._v(" "),_("li",[this._v("用户行为脚本以 log 为后缀;业务数据脚本以 db 为后缀")])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h3",{attrs:{id:"表字段类型"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#表字段类型"}},[this._v("#")]),this._v(" 表字段类型")])},function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ul",[v("li",[t._v("数量类型为 bigint")]),t._v(" "),v("li",[t._v("金额类型为 decimal(16,2),表示 16 位有效数字,其中小数部分 2 位")]),t._v(" "),v("li",[t._v("字符串(名字,描述信息等)类型为 string")]),t._v(" "),v("li",[t._v("主键外键类型为 string")]),t._v(" "),v("li",[t._v("时间戳类型为 bigint")])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h2",{attrs:{id:"关系建模与维度建模"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#关系建模与维度建模"}},[this._v("#")]),this._v(" 关系建模与维度建模")])},function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("table",[v("thead",[v("tr",[v("th",{staticStyle:{"text-align":"center"}},[t._v("序号")]),t._v(" "),v("th",[t._v("对比属性")]),t._v(" "),v("th",[t._v("OLTP")]),t._v(" "),v("th",[t._v("OLAP")]),t._v(" "),v("th",[t._v("备注")])])]),t._v(" "),v("tbody",[v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),v("td",[t._v("读特性")]),t._v(" "),v("td",[t._v("每次查询只返回少量记录")]),t._v(" "),v("td",[t._v("对大量记录进行汇总")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),v("td",[t._v("写特性")]),t._v(" "),v("td",[t._v("随机、低延时写入用户的输入")]),t._v(" "),v("td",[t._v("批量导入")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),v("td",[t._v("使用场景")]),t._v(" "),v("td",[t._v("用户, Java EE 项目")]),t._v(" "),v("td",[t._v("内部分析师,为决策提供支持")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),v("td",[t._v("数据表征")]),t._v(" "),v("td",[t._v("最新数据状态")]),t._v(" "),v("td",[t._v("随时间变化的历史状态")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("5")]),t._v(" "),v("td",[t._v("数据规模")]),t._v(" "),v("td",[t._v("GB")]),t._v(" "),v("td",[t._v("TB 到 PB")]),t._v(" "),v("td")])])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h2",{attrs:{id:"分层说明"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#分层说明"}},[this._v("#")]),this._v(" 分层说明")])},function(){var t=this.$createElement,_=this._self._c||t;return _("h3",{attrs:{id:"数据操作层-ods-层"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#数据操作层-ods-层"}},[this._v("#")]),this._v(" 数据操作层-ODS 层")])},function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ul",[v("li",[t._v("保持数据原貌不做任何修改,起到备份数据的作用。")]),t._v(" "),v("li",[t._v("数据采用 LZO 压缩,减少磁盘存储空间 100G 数据可以压缩到 10G 以内。")]),t._v(" "),v("li",[t._v("创建分区表,防止后续的全表扫描,在企业开发中大量使用分区表。")]),t._v(" "),v("li",[t._v("创建外部表。在企业开发中,除了自己用的临时表,创建内部表外,绝大多数场景都是创建外部表。")]),t._v(" "),v("li",[t._v("存储周期:ODS 默认保留近 30 天的数据")])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h3",{attrs:{id:"公共的信息层-dim-层"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#公共的信息层-dim-层"}},[this._v("#")]),this._v(" 公共的信息层-DIM 层")])},function(){var t=this.$createElement,_=this._self._c||t;return _("ul",[_("li",[this._v("数据机构:维表,以国家 ID 等字段为主键")]),this._v(" "),_("li",[this._v("存储周期:按需存储,一般会保留历史至今所有的数据")])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h3",{attrs:{id:"数据明细层-dwd-层"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#数据明细层-dwd-层"}},[this._v("#")]),this._v(" 数据明细层-DWD 层")])},function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ul",[v("li",[t._v("数据结构:数据结构与源系统保持一致")]),t._v(" "),v("li",[t._v("对用户行为数据解析。")]),t._v(" "),v("li",[t._v("对核心数据进行判空过滤。")]),t._v(" "),v("li",[t._v("对业务数据采用维度模型重新建模。")]),t._v(" "),v("li",[t._v("维度建模，减少后期大量 Join 操作")]),t._v(" "),v("li",[t._v("存储周期:保留历史至今所有的数据")])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h3",{attrs:{id:"数据汇总层-dws-层"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#数据汇总层-dws-层"}},[this._v("#")]),this._v(" 数据汇总层-DWS 层")])},function(){var t=this.$createElement,_=this._self._c||t;return _("ul",[_("li",[this._v("数据机构: 宽表:以业务实体进行展开,将与业务有关的相关字段和属性进行预关联,\n预处理和预计算,对业务实体进行拉伸形成宽表.汇总表:维度组合形成的汇总表")]),this._v(" "),_("li",[this._v("存储周期:原则上保留历史至今全部的数据")])])},function(){var t=this.$createElement,_=this._self._c||t;return _("h3",{attrs:{id:"ads-层"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ads-层"}},[this._v("#")]),this._v(" ADS 层")])}],!1,null,null,null);_.default=i.exports}}]);